{"version":3,"sources":["licencas.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"licencas.js","sourcesContent":["function handleData(data, textStatus, jqXHR) {\r\n    $('#resultOfSearch').empty();\r\n    $.each(data, function (i, item) {\r\n        //console.log(item);\r\n        var row = \"<div class=\\\"panel panel-default\\\">\" +\r\n            \"<div class=\\\"panel-heading\\\"><b>\" +\r\n            item.CODBEM +\r\n            \"</b></div>\" +\r\n            \"<div class=\\\"panel-body\\\">\" +\r\n            \"<p><b>Data Aquisição:</b> \" + item.DATAQI + \" </p>\" +\r\n            \"<p><b>Item:</b> \" + item.DESBEM + \" </p>\" +\r\n            \"<p><b>Descrição:</b> \" + item.DESESP + \" </p>\" +\r\n            \"<p><b>Empresa:</b> \" + item.NOMEMP + \" </p>\" +\r\n            \"<button class=\\\"btn btn-primary  btn-xs selecao\\\" type=\\\"button\\\" data-toggle=\\\"collapse\\\" \" +\r\n            \"data-target=\\\"#collapseExample\\\" aria-expanded=\\\"false\\\" aria-controls=\\\"collapseExample\\\">\" +\r\n            \"Marcar\" +\r\n            \"</button>\" +\r\n            \"</div>\" +\r\n            \"<div style='display: none' class='codemp'>\" + item.CODEMP + \"</div>\" +\r\n            \"</div>\";\r\n        $('#resultOfSearch').append(row);\r\n\r\n    });\r\n\r\n    $(\"#buttonSearch\").empty();\r\n    $(\"#buttonSearch\").append(\"Pesquisar\");\r\n\r\n}\r\nfunction trataRetorno(data,callback) {\r\n    console.log(data);\r\n    if (data.erro == 2) {\r\n        if (confirm(data.msg)) {\r\n            $.ajax({\r\n                url: '{{url('/licencas/associar')}}',\r\n                type: 'post',\r\n                data: {pat: pat, emp: emp, key: key, conf: 1},\r\n                dataType: 'json'\r\n            }).done(trataRetorno);\r\n        }\r\n    } else {\r\n        alert(data.msg);\r\n    }\r\n}\r\nfunction trataModalLicenca(data,callback) {\r\n    var LicencasAssociadas = $('#LicencasAssociadas');\r\n    var Empresa_Produto = $('#Empresa-Produto');\r\n    LicencasAssociadas.empty();\r\n    Empresa_Produto.empty();\r\n    console.log(data);\r\n    if (data.length > 0) {\r\n        $.each(data, function (i, item) {\r\n            linha = \"<div class=\\\"alert alert-warning\\\" role=\\\"alert\\\">\" +\r\n                \"Bem: \" + item.E670BEM_CODBEM + \" <a href=\\\"#\\\" class=\\\"alert-link\\\">Remover</a>\" +\r\n                \"</div>\";\r\n            LicencasAssociadas.append(linha);\r\n        });\r\n    } else {\r\n        linha = \"<div class=\\\"alert alert-success\\\" role=\\\"alert\\\">\" +\r\n            \"<b>Nenhum item associado a essa licença</b>\" +\r\n            \"</div>\";\r\n        LicencasAssociadas.append(linha);\r\n    }\r\n    callback();\r\n\r\n}\r\n$(document).ready(function () {\r\n\r\n    $.ajaxSetup({\r\n        headers: {'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')}\r\n    });\r\n    $('form').submit(function (e) {\r\n        if ($('#resultOfSearch').hasClass('col-md-4')) {\r\n            $('#resultOfSearch').toggleClass('col-md-12');\r\n            $('#resultOfSearch').toggleClass('col-md-4');\r\n\r\n\r\n            $('#historyItem').toggleClass('col-md-4');\r\n            $('#historyItem').toggleClass('display-localizaoes');\r\n\r\n            $('#historyFinancial').toggleClass('col-md-4');\r\n            $('#historyFinancial').toggleClass('display-localizaoes');\r\n        }\r\n        e.preventDefault();\r\n        $(\"#buttonSearch\").empty();\r\n        $(\"#buttonSearch\").append(\"Carregando <img src=\\\"{{asset(\"img/load/microload.gif\")}}\\\">\");\r\n        $.ajax({\r\n                url: '{{url('ativos/search')}}',\r\n            data: {pat: $('#patrimonio').val()},\r\n        type: 'get',\r\n            dataType: 'json'\r\n    }).done(handleData);\r\n    });\r\n    $(document).on('click', '.selecao', function () {\r\n        var botaoSelecao = $(this);\r\n        var selecao = $(this).parent().parent();\r\n        selecao.toggleClass('panel-default');\r\n        selecao.toggleClass('panel-warning');\r\n        if (selecao.hasClass('panel-warning')) {\r\n            var pat = selecao.find('.panel-heading').text();\r\n            var emp = selecao.find('.codemp').text();\r\n            botaoSelecao.text('Carregando...')\r\n            $.ajax({\r\n                url: '{{url('/api/licencas/associadas')}}/' + pat + \"/\" + emp,\r\n                type: 'get',\r\n                dataType: 'json',\r\n                success: function (data) {\r\n                    if (data.length > 0) {\r\n                        $.each(data, function (i, item) {\r\n                            //console.log(item);\r\n                            var rodape = \"<div class='panel-footer'>\" +\r\n                                \"<p>Empresa/Produto \" + item.name + \"/ \" + item.model + \" </p>\" +\r\n                                \"<p style='line-height: 0.5;'><b>Chave:</b> \" + item.key + \" </p>\" +\r\n\r\n                                \"</div> \"\r\n                            selecao.append(rodape);\r\n                        });\r\n                        selecao.append(\"<div class='panel-footer'><button class='btn btn-success btn-xs associarchave'>Associar chave</button></div>\");\r\n\r\n                    } else {\r\n                        var rodape = \"<div class='panel-footer'>\" +\r\n                            \"<p>Nenhuma chave associada</p>\" +\r\n                            \"<button class='btn btn-success btn-xs associarchave'>Associar chave</button>\" +\r\n                            \"</div> \"\r\n                        selecao.append(rodape);\r\n\r\n                    }\r\n\r\n                }, complete: function () {\r\n                    botaoSelecao.text('Desmarcar')\r\n                }\r\n            });\r\n        } else {\r\n            botaoSelecao.text('Marcar')\r\n            selecao.find('.panel-footer').remove();\r\n        }\r\n    });\r\n    $(document).on('click', '.associarchave', function () {\r\n        var selecao = $(this).parent().parent();\r\n        var pat = selecao.find('.panel-heading').text();\r\n        var emp = selecao.find('.codemp').text();\r\n        var key = $('#associarkey #idkey').text();\r\n        $.ajax({\r\n            url: '{{url('/licencas/associar')}}',\r\n            type: 'post',\r\n            data: {pat: pat, emp: emp, key: key},\r\n            dataType: 'json'\r\n        }).done(trataRetorno);\r\n    });\r\n    $(document).on('click', '.associarkeymodal', function () {\r\n        var idkey = $(this).parent().find('.licencakeyid').text();\r\n        var table_keys = $(this).parent().parent();\r\n        var heading_modal_associarkey = $('#Title-Empresa-Produto');\r\n        var heading_modal_key = $('#Title-Produto-Key');\r\n        $('#associarkey #idkey').text(idkey);\r\n        $('#resultOfSearch').empty();\r\n        heading_modal_associarkey.empty();\r\n        heading_modal_key.empty();\r\n        empresa = table_keys.find('.Empresa-table').text();\r\n        produto = table_keys.find('.Model-table').text();\r\n        key = table_keys.find('.Key-table').text();\r\n        heading_modal_associarkey.text(empresa + ' - ' + produto);\r\n        heading_modal_key.text(key);\r\n        $('#patrimonio').val(\"\");\r\n        $.ajax({\r\n            url: '{{url('/api/licencas/associadas')}}/' + idkey,\r\n            type: 'get',\r\n            dataType: 'json',\r\n\r\n        }).done(function (data) {\r\n            trataModalLicenca(data,function () {\r\n                $('#associarkey').modal('show');\r\n            });\r\n\r\n\r\n\r\n        });\r\n\r\n    });\r\n});"],"sourceRoot":"/source/"}